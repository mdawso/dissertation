[gd_scene load_steps=5 format=4 uid="uid://btwpv15kqp81u"]

[ext_resource type="Texture2D" uid="uid://dgrw0o8oqttqk" path="res://assets/tile.png" id="1_8jqdb"]

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_vdhxe"]
texture = ExtResource("1_8jqdb")
0:0/0 = 0
0:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-8, -8, 8, -8, 8, 8, -8, 8)

[sub_resource type="TileSet" id="TileSet_w4d7x"]
physics_layer_0/collision_layer = 1
physics_layer_0/collision_mask = 10
sources/0 = SubResource("TileSetAtlasSource_vdhxe")

[sub_resource type="GDScript" id="GDScript_clwpx"]
script/source = "extends TileMapLayer

const XS = [-21, -18, -15, -12, -9, -6, -3, 0, 3, 6, 9, 12, 15, 18]
const W = 2

const H_MIN = 1
const H_MAX = 4

var baseTiles : PackedByteArray

func _ready() -> void:
	baseTiles = tile_map_data
	if MapSettings.rand: randomise_map()
	else: set_basic_map()

func place_platform(pos : Vector2i, w : int, h : int) -> void:
	
	for x in range(pos.x, pos.x + w):
		var coords : Vector2i = Vector2i(x,-h) # -h here because stupid tile map positive y is down
		set_cell(coords, 0, Vector2i.ZERO, 0)
		
func set_basic_map() -> void:
	set_tile_map_data_from_array(baseTiles) # reset map
	for x in XS:
		var coords = Vector2i(x, 0)
		place_platform(coords, W, -1)

func randomise_map() -> void:
	set_tile_map_data_from_array(baseTiles) # reset map
	for x in XS:
		var coords = Vector2i(x, 0)
		var w = W
		var h = randi_range(H_MIN, H_MAX)
		place_platform(coords, w, h)
"

[node name="Layer0" type="TileMapLayer"]
tile_map_data = PackedByteArray("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")
tile_set = SubResource("TileSet_w4d7x")
script = SubResource("GDScript_clwpx")
